
apiVersion: v1
kind: Pod
metadata:
  name: sleep-test
  labels:
    app: sleep-test
spec:
  containers:
  - name: sleep-container
    image: bitnamilegacy/mysql:9.3.0-debian-12-r1
    command: ["sh", "-c", "sleep infinity"]
    envFrom:
    - configMapRef:
        name: redcap-db-config
    env:
    - name: DB_PASSWD
      valueFrom:
        secretKeyRef:
          name: redcap-mysql
          key: mysql-root-password
    volumeMounts:
    - mountPath: /redcap
      name: redcap-code
    - mountPath: /edocs
      name: edocs
    - mountPath: /backup-data
      name: backup-pvc
    - mountPath: /scripts
      name: backup-scripts
  restartPolicy: Never
  securityContext:
    fsGroup: 2000
    runAsUser: 2000
    runAsGroup: 2000
  volumes:
  - name: redcap-code
    persistentVolumeClaim:
      claimName: redcap-app-pvc
  - name: edocs
    persistentVolumeClaim:
      claimName: redcap-edocs-pvc
  - name: backup-pvc
    persistentVolumeClaim:
      claimName: redcap-backup-pvc
  - name: backup-scripts
    configMap:
      name: redcap-backup-scripts
      defaultMode: 493

